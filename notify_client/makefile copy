#CROSS_COMPILE ?= arm-linux-gnueabihf-
CROSS_COMPILE =
TARGET ?= notiyclient

CC := $(CROSS_COMPILE)gcc
LD := $(CROSS_COMPILE)ld
OBJCOPY := $(CROSS_COMPILE)objcopy
OBJDUMP := $(CROSS_COMPILE)objdump
HEADPATH := inc \
            src \
INCLUDE := $(patsubst %, -I %, $(HEADPATH))

SOURCE	:= src/threadpool.c \
		src/notify_client_send.c \
		src/notify_client_recv.c \
		src/notify_client_init.c \
		src/notify_client_ack_list.c

CFLAGS := -shared -fIPC -g -O2

CFILES := $(wildcard *.c src/*.c)
CFILENDIR := $(notdir  $(CFILES))
OBJS := $(patsubst %, obj/%, $(CFILENDIR:.c=.o))

.PHONY: all clean print
print:
	@echo "INCLUDE $(INCLUDE)"
	@echo "CFLAGS $(CFLAGS)"
	@echo "all:$(OBJS)"
	@echo "$(CC) $(CFLAGS) $(OBJS) -o $(TARGET)"
	@echo "$(OBJS):$(SOURCE)"
	@echo "$(CC) -c $(CFLAGS) $(INCLUDE) -o $@ $<"
print:
	@echo $(OBJS)

all:$(OBJS)
	$(CC) $(CFLAGS) $(OBJS) -o $(TARGET)
$(OBJS): obj/%.o : %.c
    $(CC) -c $(CFLAGS) $(INCLUDE) -o $@ $<
#    $(CC) -Wall -nostdlib -c -O2  $(INCLUDE) -o $@ $<
clean:
	rm -rf $(OBJS)